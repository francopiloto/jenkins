<?xml version="1.1" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" 
                   xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext" 
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.6.xsd">
    
    <changeSet author="paulo" id="20200121104303-1">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="editavel_fundacao" />
            </not>
        </preConditions>    
        <createTable tableName="editavel_fundacao">
            <column autoIncrement="true" name="id" type="SMALLINT">
                <constraints primaryKey="true" primaryKeyName="editavel_fundacaoPK"/>
            </column>
            <column name="cnpj" type="VARCHAR(30)">
                <constraints nullable="false"/>
            </column>
            <column name="cp" type="VARCHAR(16)">
                <constraints nullable="false"/>
            </column>
            <column name="email" type="VARCHAR(80)">
                <constraints nullable="false"/>
            </column>
            <column name="fax" type="VARCHAR(15)"/>
            <column name="inscricao_estadual" type="VARCHAR(16)">
                <constraints nullable="false"/>
            </column>
            <column name="nome" type="VARCHAR(80)">
                <constraints nullable="false"/>
            </column>
            <column name="nome_presidente" type="VARCHAR(80)">
                <constraints nullable="false"/>
            </column>
            <column name="site" type="VARCHAR(80)">
                <constraints nullable="false"/>
            </column>
            <column name="telefone" type="VARCHAR(15)"/>
            <column name="endereco_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    
    <changeSet author="paulo" id="20200121104303-2">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="editavel_polo" />
            </not>
        </preConditions>    
        <createTable tableName="editavel_polo">
            <column autoIncrement="true" name="id" type="SMALLINT">
                <constraints primaryKey="true" primaryKeyName="editavel_poloPK"/>
            </column>
            <column name="assinatura" type="VARCHAR(100)">
                <constraints nullable="false"/>
            </column>
            <column name="nome" type="VARCHAR(80)">
                <constraints nullable="false"/>
            </column>
            <column name="telefone" type="VARCHAR(15)">
                <constraints nullable="false"/>
            </column>
            <column name="endereco_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    
    <changeSet author="paulo" id="20200121104303-3">
        <addUniqueConstraint columnNames="cnpj" constraintName="UC_EDITAVEL_FUNDACAOCNPJ_COL" tableName="editavel_fundacao"/>
    </changeSet>
    
    <changeSet author="paulo" id="20200121104303-4">
        <addUniqueConstraint columnNames="cp" constraintName="UC_EDITAVEL_FUNDACAOCP_COL" tableName="editavel_fundacao"/>
    </changeSet>
    
    <changeSet author="paulo" id="20200121104303-5">
        <addUniqueConstraint columnNames="inscricao_estadual" constraintName="UC_EDITAVEL_FUNDACAOINSCRICAO_ESTADUAL_COL" tableName="editavel_fundacao"/>
    </changeSet>
    
    <changeSet author="paulo" id="20200121104303-6">
        <addForeignKeyConstraint baseColumnNames="endereco_id" baseTableName="editavel_fundacao" constraintName="FK2vp8l5psixxusxfb9ywh6b4jn" deferrable="false" initiallyDeferred="false" referencedColumnNames="id" referencedTableName="endereco" validate="true"/>
    </changeSet>
    
    <changeSet author="paulo" id="20200121104303-7">
        <addForeignKeyConstraint baseColumnNames="endereco_id" baseTableName="editavel_polo" constraintName="FKgbl9l425rarvjuvuyp2vrw1m5" deferrable="false" initiallyDeferred="false" referencedColumnNames="id" referencedTableName="endereco" validate="true"/>
    </changeSet>
    
</databaseChangeLog>
